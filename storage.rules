rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    // قواعد لصور المحادثات
    match /chat-images/{chatId}/{fileName} {
      allow read: if true; // أي شخص يمكنه القراءة
      allow write: if request.auth != null // يجب أن يكون مسجل دخول
                   && request.resource.size < 10 * 1024 * 1024 // حد أقصى 10 MB
                   && request.resource.contentType.matches('image/.*'); // صور فقط
    }

    // قواعد للملفات الصوتية
    match /chat-audio/{chatId}/{fileName} {
      allow read: if true;
      allow write: if request.auth != null
                   && request.resource.size < 5 * 1024 * 1024 // حد أقصى 5 MB
                   && request.resource.contentType.matches('audio/.*'); // صوت فقط
    }

    // قواعد للملفات العامة
    match /chat-files/{chatId}/{fileName} {
      allow read: if true;
      allow write: if request.auth != null
                   && request.resource.size < 20 * 1024 * 1024; // حد أقصى 20 MB
    }

    // قواعد لصور الموظفين (الصور الشخصية)
    match /employees/{employeeId}/avatar {
      allow read: if true;
      allow write: if request.auth != null
                   && request.resource.size < 2 * 1024 * 1024 // حد أقصى 2 MB
                   && request.resource.contentType.matches('image/.*');
    }

    // منع الوصول لأي مسارات أخرى
    match /{allPaths=**} {
      allow read, write: if false;
    }
  }
}
