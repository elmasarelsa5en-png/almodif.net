'use client';

import { type ComponentType, useEffect, useMemo, useState } from 'react';
import { useRouter } from 'next/navigation';
import { Badge } from '@/components/ui/badge';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Input } from '@/components/ui/input';
import { Textarea } from '@/components/ui/textarea';
import { Switch } from '@/components/ui/switch';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { LogoUploader } from '@/components/settings/logo-uploader';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
import { SoundSettings } from '@/components/settings/sound-settings';
import {
  Activity,
  BadgeCheck,
  Bell,
  BellRing,
  Building2,
  CheckCircle2,
  BookOpen,
  ChevronRight,
  CloudDownload,
  Database,
  Globe,
  Link2,
  Lock,
  Mail,
  MessageSquare,
  Palette,
  Phone,
  RefreshCcw,
  Search,
  ServerCog,
  Settings,
  Share2,
  Shield,
  ShieldAlert,
  ShieldCheck,
  Sparkles,
  Users,
  Zap
} from 'lucide-react';

type IconType = ComponentType<{ className?: string }>;

interface GeneralSettings {
  companyName: string;
  companyTagline: string;
  industry: string;
  branchCount: number;
  language: string;
  timezone: string;
  dateFormat: string;
  currency: string;
  systemMode: string;
}

interface NotificationSettings {
  enableEmail: boolean;
  enableSMS: boolean;
  enablePush: boolean;
  soundEnabled: boolean;
  dailyDigest: boolean;
  attendanceAlerts: boolean;
  financeAlerts: boolean;
  disableQuietHours: boolean;
}

interface SecuritySettings {
  twoFactor: boolean;
  autoLogoutMinutes: number;
  allowGuestLogin: boolean;
  passwordRotationDays: number;
  biometricSupport: boolean;
  loginAlerts: boolean;
  ipRestriction: boolean;
  maintenanceMode: boolean;
}

interface IntegrationSettings {
  whatsapp: boolean;
  accounting: boolean;
  inventory: boolean;
  crm: boolean;
  googleCalendar: boolean;
  slack: boolean;
  customWebhooks: boolean;
}

interface BackupSettings {
  autoBackup: boolean;
  backupFrequency: string;
  lastBackup: string;
  retentionDays: number;
  offsiteReplication: boolean;
  compressBackups: boolean;
}

interface AppearanceSettings {
  accentColor: string;
  layoutDensity: string;
  bubbleBackground: boolean;
  animatedTransitions: boolean;
  showTips: boolean;
}

interface AdvancedSettings {
  autoUpdates: boolean;
  betaFeatures: boolean;
  cacheSize: number;
  monitorPerformance: boolean;
  purgeLogs: boolean;
}

interface WebsiteSettings {
  siteName: string;
  siteUrl: string;
  siteDescription: string;
  metaTitle: string;
  metaKeywords: string;
  contactEmail: string;
  contactPhone: string;
  socialFacebook: string;
  socialInstagram: string;
  socialTwitter: string;
  enableBookingWidget: boolean;
  enableLiveChat: boolean;
  maintenanceMode: boolean;
}

interface StoredSettings {
  general: GeneralSettings;
  notifications: NotificationSettings;
  security: SecuritySettings;
  integrations: IntegrationSettings;
  backups: BackupSettings;
  appearance: AppearanceSettings;
  advanced: AdvancedSettings;
  website: WebsiteSettings;
}

type BooleanKeys<T> = {
  [K in keyof T]-?: T[K] extends boolean ? K : never;
}[keyof T];

interface ToggleConfig<K> {
  key: K;
  label: string;
  description: string;
  icon?: IconType;
}

const STORAGE_KEY = 'system:settings:v1';

const defaultSettings: StoredSettings = {
  general: {
    companyName: 'äÙÇã ÇáãÖíİ ÇáĞßí',
    companyTagline: 'Íáæá ãÊßÇãáÉ áÅÏÇÑÉ ÇáÖíÇİÉ æÇáÚãáíÇÊ ÇáÊÔÛíáíÉ',
    industry: 'ÇáÖíÇİÉ æÇáİäÏŞÉ',
    branchCount: 3,
    language: 'ar',
    timezone: 'Asia/Riyadh',
    dateFormat: 'DD/MM/YYYY',
    currency: 'SAR',
    systemMode: 'dark'
  },
  notifications: {
    enableEmail: true,
    enableSMS: false,
    enablePush: true,
    soundEnabled: true,
    dailyDigest: true,
    attendanceAlerts: true,
    financeAlerts: true,
    disableQuietHours: false
  },
  security: {
    twoFactor: true,
    autoLogoutMinutes: 30,
    allowGuestLogin: false,
    passwordRotationDays: 90,
    biometricSupport: false,
    loginAlerts: true,
    ipRestriction: false,
    maintenanceMode: false
  },
  integrations: {
    whatsapp: true,
    accounting: true,
    inventory: true,
    crm: true,
    googleCalendar: false,
    slack: false,
    customWebhooks: true
  },
  backups: {
    autoBackup: true,
    backupFrequency: 'daily',
    lastBackup: '2025-10-10 04:30',
    retentionDays: 30,
    offsiteReplication: true,
    compressBackups: true
  },
  appearance: {
    accentColor: 'indigo',
    layoutDensity: 'comfortable',
    bubbleBackground: true,
    animatedTransitions: true,
    showTips: false
  },
  advanced: {
    autoUpdates: true,
    betaFeatures: false,
    cacheSize: 512,
    monitorPerformance: true,
    purgeLogs: false
  },
  website: {
    siteName: 'äÙÇã ÇáãÖíİ ÇáĞßí',
    siteUrl: 'https://almodif.com',
    siteDescription: 'äÙÇã ÔÇãá áÅÏÇÑÉ ÇáÖíÇİÉ æÇáÚãáíÇÊ ÇáÊÔÛíáíÉ ÈßİÇÁÉ ÚÇáíÉ',
    metaTitle: 'ÇáãÖíİ ÇáĞßí - äÙÇã ÅÏÇÑÉ ÇáÖíÇİÉ',
    metaKeywords: 'ÅÏÇÑÉ ÇáİäÇÏŞ¡ ÍÌæÒÇÊ¡ ÔŞŞ ãİÑæÔÉ¡ ÅÏÇÑÉ ÇáÖíÇİÉ',
    contactEmail: 'info@almodif.com',
    contactPhone: '+966 50 123 4567',
    socialFacebook: 'https://facebook.com/almodif',
    socialInstagram: 'https://instagram.com/almodif',
    socialTwitter: 'https://twitter.com/almodif',
    enableBookingWidget: true,
    enableLiveChat: true,
    maintenanceMode: false
  }
};

const mergeSettings = (base: StoredSettings, incoming: Partial<StoredSettings>): StoredSettings => ({
  general: { ...base.general, ...(incoming.general ?? {}) },
  notifications: { ...base.notifications, ...(incoming.notifications ?? {}) },
  security: { ...base.security, ...(incoming.security ?? {}) },
  integrations: { ...base.integrations, ...(incoming.integrations ?? {}) },
  backups: { ...base.backups, ...(incoming.backups ?? {}) },
  appearance: { ...base.appearance, ...(incoming.appearance ?? {}) },
  advanced: { ...base.advanced, ...(incoming.advanced ?? {}) },
  website: { ...base.website, ...(incoming.website ?? {}) }
});

const NOTIFICATION_TOGGLES: ToggleConfig<BooleanKeys<NotificationSettings>>[] = [
  {
    key: 'enableEmail',
    label: 'ÊäÈíåÇÊ ÇáÈÑíÏ ÇáÅáßÊÑæäí',
    description: 'ÅÑÓÇá ÅÔÚÇÑÇÊ ãİÕáÉ æãáÎÕ íæãí ÚÈÑ ÇáÈÑíÏ.',
    icon: Bell
  },
  {
    key: 'enableSMS',
    label: 'ÑÓÇÆá SMS ÇáİæÑíÉ',
    description: 'ÊäÈíåÇÊ ÚÇÌáÉ ááÍÇáÇÊ ÇáÍÑÌÉ ãÈÇÔÑÉ Åáì ÇáÌæÇá.',
    icon: BellRing
  },
  {
    key: 'enablePush',
    label: 'ÅÔÚÇÑÇÊ ÏÇÎá ÇáäÙÇã',
    description: 'ÚÑÖ ÊäÈíåÇÊ áÍÙíÉ Úáì áæÍÉ ÇáÊÍßã æÇáÊØÈíŞÇÊ.',
    icon: Activity
  },
  {
    key: 'soundEnabled',
    label: 'ÊÔÛíá ÇáãÄËÑÇÊ ÇáÕæÊíÉ',
    description: 'ÅÖÇİÉ ãÄËÑÇÊ ÎÇÕÉ áßá ÍÏË ãåã ÏÇÎá ÇáäÙÇã.',
    icon: Sparkles
  },
  {
    key: 'dailyDigest',
    label: 'ÇáÊŞÑíÑ Çáíæãí ÇáãÌãÚ',
    description: 'æÕæá ÊŞÑíÑ ÕÈÇÍí ÈÃåã ÇáãÄÔÑÇÊ ÇáÊÔÛíáíÉ.',
    icon: RefreshCcw
  },
  {
    key: 'attendanceAlerts',
    label: 'ÊäÈíåÇÊ ÇáÍÖæÑ æÇáÇäÕÑÇİ',
    description: 'ãÑÇŞÈÉ ÇáÊÃÎíÑ¡ ÇáÛíÇÈ¡ Ãæ ÊÓÌíá ÇáÎÑæÌ ÇáãÈßÑ.',
    icon: Users
  },
  {
    key: 'financeAlerts',
    label: 'ÊäÈíåÇÊ ÇáÚãáíÇÊ ÇáãÇáíÉ',
    description: 'ãÑÇŞÈÉ ÇáİæÇÊíÑ æÇáãÕÇÑíİ ÛíÑ ÇáãÚÊÇÏÉ İæÑ ÍÏæËåÇ.',
    icon: Database
  }
];

const SECURITY_TOGGLES: ToggleConfig<BooleanKeys<SecuritySettings>>[] = [
  {
    key: 'twoFactor',
    label: 'ÊİÚíá ÇáãÕÇÏŞÉ ÇáËäÇÆíÉ',
    description: 'ÅÖÇİÉ ØÈŞÉ ÍãÇíÉ ÅÖÇİíÉ ÚäÏ ÊÓÌíá ÇáÏÎæá.',
    icon: ShieldCheck
  },
  {
    key: 'allowGuestLogin',
    label: 'ÏÎæá ÇáÖíæİ ÇáãÄŞÊ',
    description: 'ãäÍ ÕáÇÍíÇÊ ãÍÏæÏÉ ááãæÑÏíä Ãæ ÇáÖíæİ.',
    icon: Users
  },
  {
    key: 'biometricSupport',
    label: 'ÇáÊæËíŞ ÇáÍíæí',
    description: 'ÊİÚíá ÇáÏÎæá ÈÈÕãÉ ÇáÅÕÈÚ Ãæ ÇáæÌå İí ÇáÊØÈíŞÇÊ.',
    icon: Sparkles
  },
  {
    key: 'loginAlerts',
    label: 'ÊäÈíåÇÊ ÊÓÌíá ÇáÏÎæá ÇáÌÏíÏÉ',
    description: 'ÅÔÚÇÑ İæÑí ÚäÏ ÇáÏÎæá ãä ÌåÇÒ Ãæ ãæŞÚ ÌÏíÏ.',
    icon: Shield
  },
  {
    key: 'ipRestriction',
    label: 'ÊŞííÏ ÇáÏÎæá ÈÍÓÈ IP',
    description: 'ÇáÓãÇÍ ÈÇáæÕæá İŞØ ãä ÇáÔÈßÇÊ ÇáãÚÊãÏÉ.',
    icon: Lock
  },
  {
    key: 'maintenanceMode',
    label: 'æÖÚ ÇáÕíÇäÉ ÇáÚÇã',
    description: 'ÚÑÖ ÑÓÇáÉ ÕíÇäÉ æÅíŞÇİ ÇáÚãáíÇÊ ÇáÍÑÌÉ ãÄŞÊğÇ.',
    icon: ShieldAlert
  }
];

const INTEGRATION_OPTIONS: ToggleConfig<BooleanKeys<IntegrationSettings>>[] = [
  {
    key: 'whatsapp',
    label: 'ÊßÇãá æÇÊÓÇÈ ááÃÚãÇá',
    description: 'ãÒÇãäÉ ÇáãÍÇÏËÇÊ æÇáÑÏæÏ ãÚ İÑíŞ ÎÏãÉ ÇáÚãáÇÁ.',
    icon: BellRing
  },
  {
    key: 'accounting',
    label: 'ÇáÃäÙãÉ ÇáãÍÇÓÈíÉ',
    description: 'ÇÓÊíÑÇÏ ÇáŞíæÏ æÊÍÏíË ÇáÍÑßÇÊ ÇáãÇáíÉ ÊáŞÇÆíğÇ.',
    icon: Database
  },
  {
    key: 'inventory',
    label: 'ÅÏÇÑÉ ÇáãÎÒæä',
    description: 'ÊÈÇÏá ÈíÇäÇÊ ÇáÃÕäÇİ æÇáãÓÊæÏÚÇÊ İí ÇáæŞÊ ÇáİÚáí.',
    icon: CloudDownload
  },
  {
    key: 'crm',
    label: 'ÅÏÇÑÉ ÚáÇŞÇÊ ÇáÚãáÇÁ',
    description: 'ÏãÌ ÈíÇäÇÊ ÇáÚãáÇÁ æÓÌá ÇáÊİÇÚá İí ãßÇä æÇÍÏ.',
    icon: Users
  },
  {
    key: 'googleCalendar',
    label: 'ÊŞæíã Google',
    description: 'ãÒÇãäÉ ÇáãæÇÚíÏ æÇáÇÌÊãÇÚÇÊ ãÚ İÑíŞ ÇáÚãá.',
    icon: RefreshCcw
  },
  {
    key: 'customWebhooks',
    label: 'ÊßÇãáÇÊ ãÎÕøÕÉ (Webhook)',
    description: 'ÑÈØ ÇáäÙÇã ãÚ Ãí ãäÕÉ ÎÇÑÌíÉ ÈÇÓÊÎÏÇã Webhook.',
    icon: Link2
  }
];

const BACKUP_TOGGLES: ToggleConfig<BooleanKeys<BackupSettings>>[] = [
  {
    key: 'autoBackup',
    label: 'ÊÔÛíá ÇáäÓÎ ÇáÊáŞÇÆí',
    description: 'ÅäÔÇÁ äÓÎÉ ÇÍÊíÇØíÉ æİŞğÇ ááÌÏæá ÇáãÍÏÏ.',
    icon: RefreshCcw
  },
  {
    key: 'offsiteReplication',
    label: 'äÓÎ ÎÇÑÌ ÇáãæŞÚ',
    description: 'ÍİÙ äÓÎÉ ãÔİÑÉ İí ãÑßÒ ÈíÇäÇÊ ãäİÕá.',
    icon: CloudDownload
  },
  {
    key: 'compressBackups',
    label: 'ÖÛØ ÇáäÓÎ ÇáÇÍÊíÇØíÉ',
    description: 'ÊŞáíá ÍÌã ÇáãáİÇÊ ãÚ ÇáÍİÇÙ Úáì ÇáÏŞÉ.',
    icon: Activity
  }
];

const APPEARANCE_TOGGLES: ToggleConfig<BooleanKeys<AppearanceSettings>>[] = [
  {
    key: 'bubbleBackground',
    label: 'ÎáİíÉ ÇáİŞÇÚÇÊ ÇáÊİÇÚáíÉ',
    description: 'ÅÖÇİÉ ÊÃËíÑ ÈÕÑí ÏíäÇãíßí İí ÇáæÇÌåÉ.',
    icon: Sparkles
  },
  {
    key: 'animatedTransitions',
    label: 'ÇáÇäÊŞÇáÇÊ ÇáãÊÍÑßÉ',
    description: 'ÊäŞá ÏíäÇãíßí æÓáÓ Èíä ÇáÕİÍÇÊ.',
    icon: Activity
  },
  {
    key: 'showTips',
    label: 'ÊáãíÍÇÊ ÇáÇÓÊÎÏÇã ÇáĞßíÉ',
    description: 'ÚÑÖ ÅÑÔÇÏÇÊ ãæÌåÉ ááãÓÊÎÏãíä ÇáÌÏÏ.',
    icon: BadgeCheck
  }
];

const ADVANCED_TOGGLES: ToggleConfig<BooleanKeys<AdvancedSettings>>[] = [
  {
    key: 'autoUpdates',
    label: 'ÇáÊÍÏíËÇÊ ÇáÊáŞÇÆíÉ',
    description: 'ÊËÈíÊ ÃÍÏË ÇáÊÍÓíäÇÊ İæÑ ÊæİÑåÇ.',
    icon: RefreshCcw
  },
  {
    key: 'betaFeatures',
    label: 'ÊÌÑÈÉ ÇáãíÒÇÊ ÇáÊÌÑíÈíÉ',
    description: 'ÇÎÊÈÇÑ ÇáãíÒÇÊ ŞÈá ÅÕÏÇÑåÇ ÇáÑÓãí.',
    icon: Sparkles
  },
  {
    key: 'monitorPerformance',
    label: 'ãÑÇŞÈÉ ÇáÃÏÇÁ ÇááÍÙí',
    description: 'ÌãÚ ãÄÔÑÇÊ ÇáÃÏÇÁ æÅÑÓÇá ÊäÈíåÇÊ İæÑíÉ.',
    icon: Activity
  },
  {
    key: 'purgeLogs',
    label: 'ÊäÙíİ ÇáÓÌáÇÊ ÇáŞÏíãÉ',
    description: 'ÍĞİ ÇáÓÌáÇÊ ÈÚÏ ÇäÊåÇÁ ÕáÇÍíÊåÇ ÊáŞÇÆíğÇ.',
    icon: Zap
  }
];

const BACKUP_FREQUENCIES = [
  { value: 'hourly', label: 'ßá ÓÇÚÉ' },
  { value: 'daily', label: 'íæãíğÇ' },
  { value: 'weekly', label: 'ÃÓÈæÚíğÇ' },
  { value: 'monthly', label: 'ÔåÑíğÇ' }
];

const ACCENT_OPTIONS = [
  { value: 'indigo', label: 'ÃÒÑŞ ÈäİÓÌí' },
  { value: 'emerald', label: 'ÃÎÖÑ ÒãÑÏí' },
  { value: 'amber', label: 'ĞåÈí İÇÎÑ' },
  { value: 'rose', label: 'æÑÏí ÏÇİÆ' },
  { value: 'slate', label: 'ÑãÇÏí ÇÍÊÑÇİí' }
];

const DENSITY_OPTIONS = [
  { value: 'compact', label: 'ãÖÛæØ' },
  { value: 'comfortable', label: 'ãÑíÍ' },
  { value: 'spacious', label: 'æÇÓÚ' }
];

interface ToggleRowProps {
  icon?: IconType;
  label: string;
  description: string;
  checked: boolean;
  onCheckedChange: (value: boolean) => void;
}

const ToggleRow = ({ icon: Icon, label, description, checked, onCheckedChange }: ToggleRowProps) => (
  <div className="flex items-start justify-between gap-4 rounded-2xl border border-slate-800/80 bg-slate-900/50 p-4">
    <div className="space-y-1">
      <div className="flex items-center gap-2 text-slate-100">
        {Icon ? <Icon className="w-4 h-4 text-purple-300" /> : null}
        <span className="text-sm font-semibold">{label}</span>
      </div>
      <p className="text-xs text-slate-400 leading-5">{description}</p>
    </div>
    <Switch checked={checked} onCheckedChange={onCheckedChange} />
  </div>
);

export default function SettingsPage() {
  const router = useRouter();
  const [settings, setSettings] = useState<StoredSettings>(defaultSettings);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    if (typeof window === 'undefined') return;
    const stored = localStorage.getItem(STORAGE_KEY);
    if (!stored) {
      setSettings(defaultSettings);
      setLoading(false);
      return;
    }

    try {
      const parsed = JSON.parse(stored) as Partial<StoredSettings>;
      setSettings(mergeSettings(defaultSettings, parsed));
    } catch (error) {
      setSettings(defaultSettings);
    }

    setLoading(false);
  }, []);

  useEffect(() => {
    if (loading || typeof window === 'undefined') return;
    localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));
  }, [settings, loading]);

  const updateSetting = <Section extends keyof StoredSettings, Key extends keyof StoredSettings[Section]>(
    section: Section,
    key: Key,
    value: StoredSettings[Section][Key]
  ) => {
    setSettings((prev) => ({
      ...prev,
      [section]: {
        ...prev[section],
        [key]: value
      }
    }));
  };

  const resetSettings = () => setSettings(defaultSettings);

  const activeIntegrations = useMemo(
    () => Object.values(settings.integrations).filter(Boolean).length,
    [settings.integrations]
  );

  const activeNotificationChannels = useMemo(
    () =>
      [
        settings.notifications.enableEmail,
        settings.notifications.enableSMS,
        settings.notifications.enablePush,
        settings.notifications.soundEnabled
      ].filter(Boolean).length,
    [settings.notifications]
  );

  const stats = useMemo(
    () => [
      {
        icon: Building2,
        title: 'ÇáİÑæÚ ÇáäÔØÉ',
        value: settings.general.branchCount,
        badge: 'äãæ +2 åĞÇ ÇáÔåÑ'
      },
      {
        icon: Bell,
        title: 'ŞäæÇÊ ÇáÊäÈíå ÇáİÚÇáÉ',
        value: `${activeNotificationChannels}/4`,
        badge: settings.notifications.dailyDigest ? 'ÇáÊŞÑíÑ Çáíæãí ãİÚá' : 'ÇáÊŞÑíÑ Çáíæãí ãÊæŞİ'
      },
      {
        icon: ShieldCheck,
        title: 'ãÓÊæì ÇáÃãÇä',
        value: settings.security.twoFactor ? 'ãÑÊİÚ' : 'ãÊæÓØ',
        badge: settings.security.twoFactor ? 'ÇáãÕÇÏŞÉ ÇáËäÇÆíÉ ãİÚøáÉ' : 'íäÕÍ ÈÊİÚíá 2FA'
      },
      {
        icon: Database,
        title: 'ÍÇáÉ ÇáäÓÎ ÇáÇÍÊíÇØí',
        value: settings.backups.autoBackup ? settings.backups.backupFrequency : 'íÏæí',
        badge: `ÂÎÑ äÓÎÉ: ${settings.backups.lastBackup}`
      }
    ], [settings, activeNotificationChannels]
  );

  const quickActions = useMemo(
    () => [
      {
        icon: Globe,
        title: 'ÅÚÏÇÏÇÊ ÇáãæŞÚ ÇáÅáßÊÑæäí',
        description: 'ÊÍÏíË ãÚáæãÇÊ ÇáãæŞÚ æÇáÊæÇÕá æãÍÑßÇÊ ÇáÈÍË.',
        action: 'website'
      },
      {
        icon: Users,
        title: 'ÅÏÇÑÉ ÇáÕáÇÍíÇÊ',
        description: 'ÊÚííä ÇáÃÏæÇÑ æÇáæÕæá áßá İÑíŞ Úãá.',
        href: '/settings/hr'
      },
      {
        icon: BookOpen,
        title: 'ßÊÇáæÌ ÇáÔŞŞ',
        description: 'ÅÏÇÑÉ ÃäæÇÚ ÇáÔŞŞ æÇáÛÑİ æÃÓÚÇÑåÇ.',
        href: '/settings/rooms-catalog'
      },
      {
        icon: Building2,
        title: 'ÅÏÇÑÉ ÇáãæÇÑÏ ÇáÈÔÑíÉ',
        description: 'ÅÖÇİÉ æÊÚÏíá ÇáãæÙİíä æÇáÕáÇÍíÇÊ.',
        href: '/settings/hr'
      },
      {
        icon: BellRing,
        title: 'ÅÚÏÇÏÇÊ ÇáÃÕæÇÊ',
        description: 'ÊÎÕíÕ äÛãÇÊ ÇáÊäÈíå áßá ÍÏË ãåã.',
        href: '/settings/sound-settings'
      },
      {
        icon: ServerCog,
        title: 'ÌÏæáÉ ÇáäÓÎ ÇáÇÍÊíÇØí',
        description: 'ãÑÇÌÚÉ ÊæŞíÊ ÇáäÓÎ ÇáÇÍÊíÇØíÉ ÇáŞÇÏãÉ.',
        href: '/dashboard/accounting/reports'
      }
    ], []
  );

  if (loading) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-950 via-slate-900 to-purple-950" dir="rtl">
        <div className="flex flex-col items-center gap-3">
          <div className="w-14 h-14 rounded-full border-2 border-dashed border-purple-400 animate-spin" />
          <p className="text-sm text-slate-300">ÌÇÑ ÊÍãíá ÅÚÏÇÏÇÊ ÇáäÙÇã...</p>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-purple-950 p-6" dir="rtl">
      <div className="max-w-6xl mx-auto space-y-8">
        <header className="flex flex-col gap-6 lg:flex-row lg:items-center lg:justify-between">
          <div className="flex items-start gap-4">
            <div className="w-16 h-16 bg-gradient-to-br from-purple-500 to-violet-600 rounded-2xl flex items-center justify-center shadow-lg shadow-purple-900/40">
              <Settings className="w-7 h-7 text-white" />
            </div>
            <div className="space-y-2">
              <div className="flex items-center gap-3">
                <Badge variant="secondary" className="bg-emerald-500/20 text-emerald-200 border-emerald-500/30">
                  äÙÇã ãÊßÇãá
                </Badge>
                <BadgeCheck className="w-5 h-5 text-emerald-300" />
              </div>
              <h1 className="text-4xl font-bold text-white">áæÍÉ ÅÚÏÇÏÇÊ ÇáäÙÇã</h1>
              <p className="text-slate-300 text-sm leading-6 max-w-2xl">
                ÊÍßã ßÇãá İí ÇáåæíÉ¡ ÇáÊäÈíåÇÊ¡ ÇáÃãÇä¡ ÇáÊßÇãáÇÊ¡ ÇáäÓÎ ÇáÇÍÊíÇØí¡ ÇáãÙåÑ¡ æÇáÎíÇÑÇÊ ÇáãÊŞÏãÉ ãä ãßÇä æÇÍÏ.
              </p>
            </div>
          </div>
          <div className="flex gap-3">
            <Button
              onClick={resetSettings}
              variant="outline"
              className="border-red-400/40 text-red-200 bg-red-500/10 hover:bg-red-500/20"
            >
              ÅÚÇÏÉ ÊÚííä ÇáÅÚÏÇÏÇÊ
            </Button>
            <Button
              onClick={() => router.push('/dashboard')}
              variant="outline"
              className="border-white/20 bg-gray-700/30 text-white hover:bg-gray-800/50"
            >
              <ChevronRight className="ml-2 w-5 h-5" />
              ÇáÚæÏÉ ááæÍÉ ÇáÊÍßã
            </Button>
          </div>
        </header>

        <section className="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4">
          {stats.map((stat) => {
            const Icon = stat.icon;
            return (
              <Card key={stat.title} className="border-slate-700/60 bg-slate-900/60 backdrop-blur-md shadow-lg">
                <CardContent className="p-5 space-y-4">
                  <div className="flex items-center justify-between">
                    <div className="p-2 rounded-xl bg-slate-900/70 border border-white/10">
                      <Icon className="w-5 h-5 text-white" />
                    </div>
                    <Badge className="bg-gray-800/50 border-white/20 text-white text-[11px]" variant="outline">
                      {stat.badge}
                    </Badge>
                  </div>
                  <div>
                    <p className="text-sm text-slate-200/80">{stat.title}</p>
                    <p className="text-2xl font-bold text-white mt-2">{stat.value}</p>
                  </div>
                </CardContent>
              </Card>
            );
          })}
        </section>

        <section className="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4">
          {quickActions.map((action) => {
            const Icon = action.icon;
            const handleClick = () => {
              if ('action' in action && action.action === 'website') {
                // ÇáÊãÑíÑ Åáì ŞÓã ÇáÊÈæíÈÇÊ æÊİÚíá ÊÈæíÈ ÇáãæŞÚ ÇáÅáßÊÑæäí
                const tabsList = document.querySelector('[role="tablist"]');
                if (tabsList) {
                  tabsList.scrollIntoView({ behavior: 'smooth', block: 'start' });
                  setTimeout(() => {
                    const websiteTab = document.querySelector('[value="website"]') as HTMLButtonElement;
                    if (websiteTab) {
                      websiteTab.click();
                    }
                  }, 300);
                }
              } else if ('href' in action) {
                router.push(action.href);
              }
            };
            
            return (
              <Card
                key={action.title}
                onClick={handleClick}
                className="border-slate-700/60 bg-slate-900/60 hover:bg-slate-900/80 transition-colors cursor-pointer group"
              >
                <CardContent className="p-5 space-y-4">
                  <div className="flex items-center gap-3">
                    <div className="p-2 rounded-xl bg-purple-500/20 border border-purple-400/30 group-hover:bg-purple-500/30">
                      <Icon className="w-5 h-5 text-purple-200" />
                    </div>
                    <div>
                      <h3 className="text-white font-semibold text-base">{action.title}</h3>
                      <p className="text-sm text-slate-300/80">{action.description}</p>
                    </div>
                  </div>
                </CardContent>
              </Card>
            );
          })}
        </section>

        <Card className="border-slate-700/60 bg-slate-900/50 backdrop-blur-lg shadow-xl">
          <CardHeader className="pb-6">
            <div className="flex flex-col gap-2">
              <CardTitle className="text-white text-2xl flex items-center gap-3">
                <ServerCog className="w-6 h-6 text-purple-300" />
                ÅÏÇÑÉ ÅÚÏÇÏÇÊ ÇáäÙÇã
              </CardTitle>
              <CardDescription className="text-slate-300">
                ÇÎÊÑ ÇáÊÈæíÈ ÇáãäÇÓÈ æŞã ÈÊÍÏíË ÇáÅÚÏÇÏÇÊ¡ æÓíÊã ÍİÙ ÊÛííÑÇÊß ÊáŞÇÆíğÇ.
              </CardDescription>
            </div>
          </CardHeader>
          <CardContent>
            <Tabs defaultValue="general" className="space-y-6">
              <TabsList className="flex flex-wrap gap-2 bg-slate-900/80 border border-slate-700/60 p-2 rounded-2xl text-slate-200">
                <TabsTrigger value="general" className="data-[state=active]:bg-purple-500/20 data-[state=active]:text-white">
                  ÇáÚÇã
                </TabsTrigger>
                <TabsTrigger value="website" className="data-[state=active]:bg-purple-500/20 data-[state=active]:text-white">
                  ÇáãæŞÚ ÇáÅáßÊÑæäí
                </TabsTrigger>
                <TabsTrigger value="notifications" className="data-[state=active]:bg-purple-500/20 data-[state=active]:text-white">
                  ÇáÊäÈíåÇÊ
                </TabsTrigger>
                <TabsTrigger value="security" className="data-[state=active]:bg-purple-500/20 data-[state=active]:text-white">
                  ÇáÃãÇä
                </TabsTrigger>
                <TabsTrigger value="integrations" className="data-[state=active]:bg-purple-500/20 data-[state=active]:text-white">
                  ÇáÊßÇãáÇÊ
                </TabsTrigger>
                <TabsTrigger value="backups" className="data-[state=active]:bg-purple-500/20 data-[state=active]:text-white">
                  ÇáäÓÎ ÇáÇÍÊíÇØí
                </TabsTrigger>
                <TabsTrigger value="appearance" className="data-[state=active]:bg-purple-500/20 data-[state=active]:text-white">
                  ÇáãÙåÑ
                </TabsTrigger>
                <TabsTrigger value="advanced" className="data-[state=active]:bg-purple-500/20 data-[state=active]:text-white">
                  ãÊŞÏã
                </TabsTrigger>
              </TabsList>

              <TabsContent value="general" className="space-y-6">
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                  <Card className="border-slate-700/60 bg-slate-900/60">
                    <CardHeader>
                      <CardTitle className="text-white text-lg flex items-center gap-2">
                        <Building2 className="w-5 h-5 text-purple-300" />
                        åæíÉ ÇáãäÔÃÉ
                      </CardTitle>
                      <CardDescription className="text-slate-300">
                        ÊÚÏíá ÇáåæíÉ ÇáãÚÑæÖÉ İí ÇáİæÇÊíÑ æÇáÊŞÇÑíÑ ÇáÑÓãíÉ.
                      </CardDescription>
                    </CardHeader>
                    <CardContent className="space-y-5">
                      <div className="space-y-2">
                        <label className="text-sm text-slate-200">ÇÓã ÇáãäÔÃÉ</label>
                        <Input
                          value={settings.general.companyName}
                          onChange={(event) => updateSetting('general', 'companyName', event.target.value)}
                          className="bg-slate-950 border-slate-700 text-white"
                        />
                      </div>
                      <div className="space-y-2">
                        <LogoUploader />
                        <label className="text-sm text-slate-200">ÇáÔÚÇÑ ÇáãÎÊÕÑ</label>
                        <Textarea
                          rows={3}
                          value={settings.general.companyTagline}
                          onChange={(event) => updateSetting('general', 'companyTagline', event.target.value)}
                          className="bg-slate-950 border-slate-700 text-white"
                        />
                      </div>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="space-y-2">
                          <label className="text-sm text-slate-200">ÇáŞØÇÚ</label>
                          <Input
                            value={settings.general.industry}
                            onChange={(event) => updateSetting('general', 'industry', event.target.value)}
                            className="bg-slate-950 border-slate-700 text-white"
                          />
                        </div>
                        <div className="space-y-2">
                          <label className="text-sm text-slate-200">ÚÏÏ ÇáİÑæÚ</label>
                          <Input
                            type="number"
                            min={1}
                            value={settings.general.branchCount}
                            onChange={(event) => {
                              const value = Number(event.target.value);
                              updateSetting(
                                'general',
                                'branchCount',
                                Number.isNaN(value) || value < 1 ? 1 : value
                              );
                            }}
                            className="bg-slate-950 border-slate-700 text-white"
                          />
                        </div>
                      </div>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="space-y-2">
                          <label className="text-sm text-slate-200">ÇááÛÉ ÇáÑÆíÓíÉ</label>
                          <Select
                            value={settings.general.language}
                            onValueChange={(value) => updateSetting('general', 'language', value)}
                          >
                            <SelectTrigger className="bg-slate-950 border-slate-700 text-white">
                              <SelectValue placeholder="ÇÎÊÑ ÇááÛÉ" />
                            </SelectTrigger>
                            <SelectContent className="bg-slate-950 border-slate-700 text-white">
                              <SelectItem value="ar">ÇáÚÑÈíÉ</SelectItem>
                              <SelectItem value="en">ÇáÅäÌáíÒíÉ</SelectItem>
                              <SelectItem value="fr">ÇáİÑäÓíÉ</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        <div className="space-y-2">
                          <label className="text-sm text-slate-200">ÇáÊæŞíÊ</label>
                          <Select
                            value={settings.general.timezone}
                            onValueChange={(value) => updateSetting('general', 'timezone', value)}
                          >
                            <SelectTrigger className="bg-slate-950 border-slate-700 text-white">
                              <SelectValue placeholder="ÇÎÊÑ ÇáÊæŞíÊ" />
                            </SelectTrigger>
                            <SelectContent className="bg-slate-950 border-slate-700 text-white">
                              <SelectItem value="Asia/Riyadh">GMT+3 | ÇáÑíÇÖ</SelectItem>
                              <SelectItem value="Asia/Dubai">GMT+4 | ÏÈí</SelectItem>
                              <SelectItem value="Europe/London">GMT | áäÏä</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                      </div>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="space-y-2">
                          <label className="text-sm text-slate-200">ÕíÛÉ ÇáÊÇÑíÎ</label>
                          <Select
                            value={settings.general.dateFormat}
                            onValueChange={(value) => updateSetting('general', 'dateFormat', value)}
                          >
                            <SelectTrigger className="bg-slate-950 border-slate-700 text-white">
                              <SelectValue placeholder="ÇÎÊÑ ÇáÕíÛÉ" />
                            </SelectTrigger>
                            <SelectContent className="bg-slate-950 border-slate-700 text-white">
                              <SelectItem value="DD/MM/YYYY">31/12/2025</SelectItem>
                              <SelectItem value="MM/DD/YYYY">12/31/2025</SelectItem>
                              <SelectItem value="YYYY-MM-DD">2025-12-31</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        <div className="space-y-2">
                          <label className="text-sm text-slate-200">ÇáÚãáÉ ÇáÑÆíÓíÉ</label>
                          <Select
                            value={settings.general.currency}
                            onValueChange={(value) => updateSetting('general', 'currency', value)}
                          >
                            <SelectTrigger className="bg-slate-950 border-slate-700 text-white">
                              <SelectValue placeholder="ÇÎÊÑ ÇáÚãáÉ" />
                            </SelectTrigger>
                            <SelectContent className="bg-slate-950 border-slate-700 text-white">
                              <SelectItem value="SAR">ÑíÇá ÓÚæÏí (SAR)</SelectItem>
                              <SelectItem value="AED">ÏÑåã ÅãÇÑÇÊí (AED)</SelectItem>
                              <SelectItem value="USD">ÏæáÇÑ ÃãÑíßí (USD)</SelectItem>
                              <SelectItem value="EUR">íæÑæ (EUR)</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                      </div>
                      <div className="space-y-2">
                        <label className="text-sm text-slate-200">æÖÚ ÇáæÇÌåÉ</label>
                        <Select
                          value={settings.general.systemMode}
                          onValueChange={(value) => updateSetting('general', 'systemMode', value)}
                        >
                          <SelectTrigger className="bg-slate-950 border-slate-700 text-white">
                            <SelectValue placeholder="ÇÎÊÑ ÇáæÖÚ" />
                          </SelectTrigger>
                          <SelectContent className="bg-slate-950 border-slate-700 text-white">
                            <SelectItem value="dark">ÇáæÖÚ ÇáÏÇßä</SelectItem>
                            <SelectItem value="light">ÇáæÖÚ ÇáİÇÊÍ</SelectItem>
                            <SelectItem value="system">ÍÓÈ ÅÚÏÇÏÇÊ ÇáÌåÇÒ</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                    </CardContent>
                  </Card>

                  <Card className="border-slate-700/60 bg-slate-900/60">
                    <CardHeader>
                      <CardTitle className="text-white text-lg flex items-center gap-2">
                        <Activity className="w-5 h-5 text-purple-300" />
                        ãæÌÒ ÇáÍÇáÉ ÇáÍÇáíÉ
                      </CardTitle>
                      <CardDescription className="text-slate-300">
                        äÙÑÉ ÓÑíÚÉ Úáì ÃÏÇÁ ÇáãäÙæãÉ æİŞ ÅÚÏÇÏÇÊß ÇáÍÇáíÉ.
                      </CardDescription>
                    </CardHeader>
                    <CardContent className="space-y-4">
                      <div className="rounded-2xl border border-slate-700/60 bg-slate-950/40 p-4 space-y-2">
                        <div className="flex items-center gap-2 text-slate-300 text-sm">
                          <Shield className="w-4 h-4 text-purple-300" />
                          ãÓÊæì ÇáÍãÇíÉ
                        </div>
                        <p className="text-white text-xl font-semibold">
                          {settings.security.twoFactor ? 'ãÍãí ÈÇáßÇãá' : 'ÍãÇíÉ ÃÓÇÓíÉ'}
                        </p>
                        <p className="text-xs text-slate-400">
                          {settings.security.loginAlerts
                            ? 'ÇáãÑÇŞÈÉ ÇááÍÙíÉ áÊÓÌíá ÇáÏÎæá İÚøÇáÉ.'
                            : 'ääÕÍ ÈÊİÚíá ÊäÈíåÇÊ ÇáÏÎæá áÊÍÓíä ÇáÍãÇíÉ.'}
                        </p>
                      </div>
                      <div className="rounded-2xl border border-slate-700/60 bg-slate-950/40 p-4 space-y-2">
                        <div className="flex items-center gap-2 text-slate-300 text-sm">
                          <Link2 className="w-4 h-4 text-purple-300" />
                          ÇáÊßÇãáÇÊ ÇáãÊÕáÉ
                        </div>
                        <p className="text-white text-xl font-semibold">{activeIntegrations} ÊßÇãáÇÊ äÔØÉ</p>
                        <p className="text-xs text-slate-400">
                          íÔãá æÇÊÓÇÈ¡ ÇáÃäÙãÉ ÇáãÍÇÓÈíÉ¡ ÇáãÎÒæä¡ æŞäæÇÊ ÇáÏÚã.
                        </p>
                      </div>
                      <div className="rounded-2xl border border-slate-700/60 bg-slate-950/40 p-4 space-y-2">
                        <div className="flex items-center gap-2 text-slate-300 text-sm">
                          <RefreshCcw className="w-4 h-4 text-purple-300" />
                          ÍÇáÉ ÇáäÓÎ ÇáÇÍÊíÇØí
                        </div>
                        <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
                          <p className="text-white text-lg font-semibold">
                            {settings.backups.autoBackup ? 'äÓÎ ÇÍÊíÇØí ÊáŞÇÆí' : 'ÇáäÓÎ ÇáÇÍÊíÇØí íÏæí'}
                          </p>
                          <div className="flex items-center gap-2 text-xs text-slate-400">
                            <CheckCircle2 className="w-4 h-4 text-emerald-300" />
                            ÂÎÑ äÓÎÉ ÚäÏ {settings.backups.lastBackup}
                          </div>
                        </div>
                      </div>
                    </CardContent>
                  </Card>
                </div>
              </TabsContent>

              <TabsContent value="website" className="space-y-6">
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                  <Card className="border-slate-700/60 bg-slate-900/60">
                    <CardHeader>
                      <CardTitle className="text-white text-lg flex items-center gap-2">
                        <Globe className="w-5 h-5 text-purple-300" />
                        ãÚáæãÇÊ ÇáãæŞÚ
                      </CardTitle>
                      <CardDescription className="text-slate-300">
                        ÊÍÏíË ãÚáæãÇÊ ÇáãæŞÚ ÇáÅáßÊÑæäí ÇáÃÓÇÓíÉ æÇáÈíÇäÇÊ ÇáæÕİíÉ.
                      </CardDescription>
                    </CardHeader>
                    <CardContent className="space-y-5">
                      <div className="space-y-2">
                        <label className="text-sm text-slate-200">ÇÓã ÇáãæŞÚ</label>
                        <Input
                          value={settings.website.siteName}
                          onChange={(event) => updateSetting('website', 'siteName', event.target.value)}
                          placeholder="ÇÓã ãæŞÚß ÇáÅáßÊÑæäí"
                          className="bg-slate-950 border-slate-700 text-white"
                        />
                      </div>
                      <div className="space-y-2">
                        <label className="text-sm text-slate-200">ÑÇÈØ ÇáãæŞÚ (URL)</label>
                        <Input
                          value={settings.website.siteUrl}
                          onChange={(event) => updateSetting('website', 'siteUrl', event.target.value)}
                          placeholder="https://example.com"
                          className="bg-slate-950 border-slate-700 text-white"
                        />
                      </div>
                      <div className="space-y-2">
                        <label className="text-sm text-slate-200">æÕİ ÇáãæŞÚ</label>
                        <Textarea
                          rows={3}
                          value={settings.website.siteDescription}
                          onChange={(event) => updateSetting('website', 'siteDescription', event.target.value)}
                          placeholder="æÕİ ãæÌÒ áãæŞÚß íÙåÑ İí ãÍÑßÇÊ ÇáÈÍË"
                          className="bg-slate-950 border-slate-700 text-white"
                        />
                      </div>
                      <div className="space-y-2">
                        <label className="text-sm text-slate-200 flex items-center gap-2">
                          <Search className="w-4 h-4" />
                          ÚäæÇä ÇáÊÍÓíä áãÍÑßÇÊ ÇáÈÍË (Meta Title)
                        </label>
                        <Input
                          value={settings.website.metaTitle}
                          onChange={(event) => updateSetting('website', 'metaTitle', event.target.value)}
                          placeholder="ÇáÚäæÇä ÇáĞí íÙåÑ İí äÊÇÆÌ ÇáÈÍË"
                          className="bg-slate-950 border-slate-700 text-white"
                        />
                      </div>
                      <div className="space-y-2">
                        <label className="text-sm text-slate-200">ÇáßáãÇÊ ÇáãİÊÇÍíÉ (Meta Keywords)</label>
                        <Textarea
                          rows={2}
                          value={settings.website.metaKeywords}
                          onChange={(event) => updateSetting('website', 'metaKeywords', event.target.value)}
                          placeholder="ÖÚ ÇáßáãÇÊ ÇáãİÊÇÍíÉ ãİÕæáÉ ÈİÇÕáÉ"
                          className="bg-slate-950 border-slate-700 text-white"
                        />
                      </div>
                    </CardContent>
                  </Card>

                  <Card className="border-slate-700/60 bg-slate-900/60">
                    <CardHeader>
                      <CardTitle className="text-white text-lg flex items-center gap-2">
                        <Mail className="w-5 h-5 text-purple-300" />
                        ãÚáæãÇÊ ÇáÇÊÕÇá
                      </CardTitle>
                      <CardDescription className="text-slate-300">
                        ÈíÇäÇÊ ÇáÊæÇÕá ÇáÊí ÊÙåÑ ááÒæÇÑ æÇáÚãáÇÁ.
                      </CardDescription>
                    </CardHeader>
                    <CardContent className="space-y-5">
                      <div className="space-y-2">
                        <label className="text-sm text-slate-200 flex items-center gap-2">
                          <Mail className="w-4 h-4" />
                          ÇáÈÑíÏ ÇáÅáßÊÑæäí
                        </label>
                        <Input
                          type="email"
                          value={settings.website.contactEmail}
                          onChange={(event) => updateSetting('website', 'contactEmail', event.target.value)}
                          placeholder="info@example.com"
                          className="bg-slate-950 border-slate-700 text-white"
                        />
                      </div>
                      <div className="space-y-2">
                        <label className="text-sm text-slate-200 flex items-center gap-2">
                          <Phone className="w-4 h-4" />
                          ÑŞã ÇáåÇÊİ
                        </label>
                        <Input
                          type="tel"
                          value={settings.website.contactPhone}
                          onChange={(event) => updateSetting('website', 'contactPhone', event.target.value)}
                          placeholder="+966 50 123 4567"
                          className="bg-slate-950 border-slate-700 text-white"
                        />
                      </div>
                      <div className="rounded-2xl border border-slate-800/70 bg-slate-950/40 p-4 space-y-3">
                        <p className="text-sm font-semibold text-slate-200 flex items-center gap-2">
                          <Share2 className="w-4 h-4" />
                          ÑæÇÈØ ãæÇŞÚ ÇáÊæÇÕá ÇáÇÌÊãÇÚí
                        </p>
                        <div className="space-y-3">
                          <Input
                            value={settings.website.socialFacebook}
                            onChange={(event) => updateSetting('website', 'socialFacebook', event.target.value)}
                            placeholder="ÑÇÈØ Facebook"
                            className="bg-slate-950 border-slate-700 text-white text-sm"
                          />
                          <Input
                            value={settings.website.socialInstagram}
                            onChange={(event) => updateSetting('website', 'socialInstagram', event.target.value)}
                            placeholder="ÑÇÈØ Instagram"
                            className="bg-slate-950 border-slate-700 text-white text-sm"
                          />
                          <Input
                            value={settings.website.socialTwitter}
                            onChange={(event) => updateSetting('website', 'socialTwitter', event.target.value)}
                            placeholder="ÑÇÈØ Twitter/X"
                            className="bg-slate-950 border-slate-700 text-white text-sm"
                          />
                        </div>
                      </div>
                    </CardContent>
                  </Card>

                  <Card className="border-slate-700/60 bg-slate-900/60 lg:col-span-2">
                    <CardHeader>
                      <CardTitle className="text-white text-lg flex items-center gap-2">
                        <Settings className="w-5 h-5 text-purple-300" />
                        ÎíÇÑÇÊ ÇáãæŞÚ ÇáãÊŞÏãÉ
                      </CardTitle>
                      <CardDescription className="text-slate-300">
                        ÊİÚíá Ãæ ÅíŞÇİ ãíÒÇÊ ÇáãæŞÚ ÇáÅáßÊÑæäí.
                      </CardDescription>
                    </CardHeader>
                    <CardContent className="space-y-4">
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <ToggleRow
                          icon={BookOpen}
                          label="ÊİÚíá äÙÇã ÇáÍÌÒ ÇáãÈÇÔÑ"
                          description="ÇáÓãÇÍ ááÚãáÇÁ ÈÇáÍÌÒ ãÈÇÔÑÉ ãä ÇáãæŞÚ ÇáÅáßÊÑæäí."
                          checked={settings.website.enableBookingWidget}
                          onCheckedChange={(value) => updateSetting('website', 'enableBookingWidget', value)}
                        />
                        <ToggleRow
                          icon={MessageSquare}
                          label="ÊİÚíá ÇáÏÑÏÔÉ ÇáãÈÇÔÑÉ"
                          description="ÊŞÏíã ÏÚã İæÑí ááÒæÇÑ ÚÈÑ äÇİĞÉ ÇáÏÑÏÔÉ ÇáãÈÇÔÑÉ."
                          checked={settings.website.enableLiveChat}
                          onCheckedChange={(value) => updateSetting('website', 'enableLiveChat', value)}
                        />
                      </div>
                      <ToggleRow
                        icon={ShieldAlert}
                        label="æÖÚ ÇáÕíÇäÉ ááãæŞÚ"
                        description="ÚÑÖ ÕİÍÉ ÕíÇäÉ ááÒæÇÑ ãÚ ÅÎİÇÁ ÇáãÍÊæì ãÄŞÊÇğ."
                        checked={settings.website.maintenanceMode}
                        onCheckedChange={(value) => updateSetting('website', 'maintenanceMode', value)}
                      />
                      <div className="rounded-2xl border border-slate-800/70 bg-slate-950/40 p-4 text-xs text-slate-400 leading-5">
                        ?? äÕíÍÉ: ÊÃßÏ ãä ÊÍÏíË ãÚáæãÇÊ ÇáãæŞÚ ÈÇäÊÙÇã áÊÍÓíä ÙåæÑß İí ãÍÑßÇÊ ÇáÈÍË æÒíÇÏÉ ËŞÉ ÇáÚãáÇÁ.
                      </div>
                    </CardContent>
                  </Card>
                </div>
              </TabsContent>

              <TabsContent value="notifications" className="space-y-6">
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                  <Card className="border-slate-700/60 bg-slate-900/60">
                    <CardHeader>
                      <CardTitle className="text-white text-lg flex items-center gap-2">
                        <Bell className="w-5 h-5 text-purple-300" />
                        ŞäæÇÊ ÇáÊäÈíå
                      </CardTitle>
                      <CardDescription className="text-slate-300">
                        ÇÎÊÑ ÇáŞäæÇÊ ÇáãäÇÓÈÉ áÊäÈíå ÇáİÑŞ ÇáÊÔÛíáíÉ İí ÇáæŞÊ ÇáãäÇÓÈ.
                      </CardDescription>
                    </CardHeader>
                    <CardContent className="space-y-4">
                      {NOTIFICATION_TOGGLES.map((toggle) => (
                        <ToggleRow
                          key={toggle.key}
                          icon={toggle.icon}
                          label={toggle.label}
                          description={toggle.description}
                          checked={settings.notifications[toggle.key]}
                          onCheckedChange={(value) => updateSetting('notifications', toggle.key, value)}
                        />
                      ))}
                    </CardContent>
                  </Card>

                  <Card className="border-slate-700/60 bg-slate-900/60">
                    <CardHeader>
                      <CardTitle className="text-white text-lg flex items-center gap-2">
                        <Sparkles className="w-5 h-5 text-purple-300" />
                        ÊÎÕíÕ ÇáÃÕæÇÊ æÇáÊÓáíã
                      </CardTitle>
                      <CardDescription className="text-slate-300">
                        ÍÏøÏ äÛãÉ áßá ÍÏË æÑÇÌÚ ÃæŞÇÊ ÇáÊÓáíã ÇáãÌÏæáÉ.
                      </CardDescription>
                    </CardHeader>
                    <CardContent className="space-y-5">
                      <SoundSettings />
                      <div className="rounded-2xl border border-slate-800/70 bg-slate-950/40 p-4 space-y-3">
                        <p className="text-sm font-semibold text-slate-200">ÊæŞíÊ ÇáÊŞÑíÑ Çáíæãí</p>
                        <Select
                          value={settings.notifications.dailyDigest ? '08:00' : 'none'}
                          onValueChange={(value) => updateSetting('notifications', 'dailyDigest', value !== 'none')}
                        >
                          <SelectTrigger className="bg-slate-950 border-slate-700 text-white">
                            <SelectValue placeholder="ÇÎÊÑ ÇáæŞÊ" />
                          </SelectTrigger>
                          <SelectContent className="bg-slate-950 border-slate-700 text-white">
                            <SelectItem value="08:00">08:00 ÕÈÇÍğÇ</SelectItem>
                            <SelectItem value="12:00">12:00 ÙåÑğÇ</SelectItem>
                            <SelectItem value="18:00">06:00 ãÓÇÁğ</SelectItem>
                            <SelectItem value="none">ÅíŞÇİ ÇáÊŞÑíÑ Çáíæãí</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                    </CardContent>
                  </Card>
                </div>
              </TabsContent>

              <TabsContent value="security" className="space-y-6">
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                  <Card className="border-slate-700/60 bg-slate-900/60">
                    <CardHeader>
                      <CardTitle className="text-white text-lg flex items-center gap-2">
                        <ShieldCheck className="w-5 h-5 text-purple-300" />
                        ÓíÇÓÇÊ ÇáÍãÇíÉ
                      </CardTitle>
                      <CardDescription className="text-slate-300">
                        İÚøá ÇáÓíÇÓÇÊ ÇáÊí ÊÖãä ÍãÇíÉ ÈíÇäÇÊ ÇáãäÔÃÉ æÇáãÓÊÎÏãíä.
                      </CardDescription>
                    </CardHeader>
                    <CardContent className="space-y-4">
                      {SECURITY_TOGGLES.map((toggle) => (
                        <ToggleRow
                          key={toggle.key}
                          icon={toggle.icon}
                          label={toggle.label}
                          description={toggle.description}
                          checked={Boolean(settings.security[toggle.key])}
                          onCheckedChange={(value) => updateSetting('security', toggle.key, value)}
                        />
                      ))}
                    </CardContent>
                  </Card>

                  <Card className="border-slate-700/60 bg-slate-900/60">
                    <CardHeader>
                      <CardTitle className="text-white text-lg flex items-center gap-2">
                        <Lock className="w-5 h-5 text-purple-300" />
                        ÖæÇÈØ ÇáÌáÓÇÊ
                      </CardTitle>
                      <CardDescription className="text-slate-300">
                        ÅÏÇÑÉ ãÏÉ ÇáÌáÓÉ æÓíÇÓÉ ÊÛííÑ ßáãÉ ÇáãÑæÑ.
                      </CardDescription>
                    </CardHeader>
                    <CardContent className="space-y-5">
                      <div className="space-y-2">
                        <label className="text-sm text-slate-200">ÇäÊåÇÁ ÇáÌáÓÉ (ÏŞÇÆŞ)</label>
                        <Input
                          type="number"
                          min={5}
                          value={settings.security.autoLogoutMinutes}
                          onChange={(event) => {
                            const value = Number(event.target.value);
                            updateSetting(
                              'security',
                              'autoLogoutMinutes',
                              Number.isNaN(value) || value < 5 ? 5 : value
                            );
                          }}
                          className="bg-slate-950 border-slate-700 text-white"
                        />
                      </div>
                      <div className="space-y-2">
                        <label className="text-sm text-slate-200">ÊÛííÑ ßáãÉ ÇáãÑæÑ (ÃíÇã)</label>
                        <Input
                          type="number"
                          min={30}
                          value={settings.security.passwordRotationDays}
                          onChange={(event) => {
                            const value = Number(event.target.value);
                            updateSetting(
                              'security',
                              'passwordRotationDays',
                              Number.isNaN(value) || value < 30 ? 30 : value
                            );
                          }}
                          className="bg-slate-950 border-slate-700 text-white"
                        />
                      </div>
                      <div className="rounded-2xl border border-slate-800/70 bg-slate-950/40 p-4 text-xs text-slate-400 leading-5">
                        Şã ÈãÑÇÌÚÉ ÓÌáÇÊ ÇáÏÎæá ÃÓÈæÚíğÇ¡ æÊÃßÏ ãä ÅíŞÇİ ÍÓÇÈÇÊ ÇáãæÙİíä ÇáÓÇÈŞíä İæÑ ãÛÇÏÑÊåã.
                      </div>
                    </CardContent>
                  </Card>
                </div>
              </TabsContent>

              <TabsContent value="integrations" className="space-y-6">
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                  <Card className="border-slate-700/60 bg-slate-900/60">
                    <CardHeader>
                      <CardTitle className="text-white text-lg flex items-center gap-2">
                        <ServerCog className="w-5 h-5 text-purple-300" />
                        ÇáÊßÇãáÇÊ ÇáãÊÇÍÉ
                      </CardTitle>
                      <CardDescription className="text-slate-300">
                        İÚøá ÇáÊßÇãáÇÊ ÇáÊí ÊÏÚã ÚãáíÇÊß ÇáíæãíÉ æÎÕÕ ÕáÇÍíÇÊåÇ.
                      </CardDescription>
                    </CardHeader>
                    <CardContent className="space-y-4">
                      {INTEGRATION_OPTIONS.map((option) => (
                        <ToggleRow
                          key={option.key}
                          icon={option.icon}
                          label={option.label}
                          description={option.description}
                          checked={settings.integrations[option.key]}
                          onCheckedChange={(value) => updateSetting('integrations', option.key, value)}
                        />
                      ))}
                    </CardContent>
                  </Card>

                  <Card className="border-slate-700/60 bg-slate-900/60">
                    <CardHeader>
                      <CardTitle className="text-white text-lg flex items-center gap-2">
                        <Link2 className="w-5 h-5 text-purple-300" />
                        ãÑÇŞÈÉ ãİÇÊíÍ ÇáÑÈØ
                      </CardTitle>
                      <CardDescription className="text-slate-300">
                        ÑÇÌÚ ÍÇáÉ ãİÇÊíÍ API æÊÃßÏ ãä ÕáÇÍíÊåÇ æÊæÒíÚåÇ ÇáÂãä.
                      </CardDescription>
                    </CardHeader>
                    <CardContent className="space-y-5">
                      <div className="rounded-2xl border border-slate-800/70 bg-slate-950/40 p-4 text-xs text-slate-400 leading-5">
                        {activeIntegrations} ÊßÇãáÇÊ äÔØÉ ÍÇáíğÇ. ääÕÍ ÈÊÌÏíÏ ÑãæÒ ÇáæÕæá ßá 90 íæãğÇ æÊæËíŞ ÈíÇäÇÊ ÇáÇÚÊãÇÏ İí ÎÒäÉ ÂãäÉ.
                      </div>
                      <Button
                        variant="outline"
                        className="w-full border-purple-400/40 text-purple-200 bg-purple-500/10 hover:bg-purple-500/20"
                        onClick={() => router.push('/dashboard/settings/keys')}
                      >
                        ÅÏÇÑÉ ãİÇÊíÍ API æÇáÊßÇãáÇÊ
                      </Button>
                    </CardContent>
                  </Card>
                </div>
              </TabsContent>

              <TabsContent value="backups" className="space-y-6">
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                  <Card className="border-slate-700/60 bg-slate-900/60">
                    <CardHeader>
                      <CardTitle className="text-white text-lg flex items-center gap-2">
                        <Database className="w-5 h-5 text-purple-300" />
                        ÓíÇÓÉ ÇáäÓÎ ÇáÇÍÊíÇØí
                      </CardTitle>
                      <CardDescription className="text-slate-300">
                        ÍÏÏ ÊßÑÇÑ ÇáäÓÎ¡ ãÏÉ ÇáÇÍÊİÇÙ¡ æÎíÇÑÇÊ ÇáÊÎÒíä ÇáãÊŞÏãÉ.
                      </CardDescription>
                    </CardHeader>
                    <CardContent className="space-y-5">
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="space-y-2">
                          <label className="text-sm text-slate-200">ÊßÑÇÑ ÇáäÓÎ ÇáÇÍÊíÇØí</label>
                          <Select
                            value={settings.backups.backupFrequency}
                            onValueChange={(value) => updateSetting('backups', 'backupFrequency', value)}
                          >
                            <SelectTrigger className="bg-slate-950 border-slate-700 text-white">
                              <SelectValue placeholder="ÇÎÊÑ ÇáÊßÑÇÑ" />
                            </SelectTrigger>
                            <SelectContent className="bg-slate-950 border-slate-700 text-white">
                              {BACKUP_FREQUENCIES.map((option) => (
                                <SelectItem key={option.value} value={option.value}>
                                  {option.label}
                                </SelectItem>
                              ))}
                            </SelectContent>
                          </Select>
                        </div>
                        <div className="space-y-2">
                          <label className="text-sm text-slate-200">ãÏÉ ÇáÇÍÊİÇÙ (ÃíÇã)</label>
                          <Input
                            type="number"
                            min={7}
                            value={settings.backups.retentionDays}
                            onChange={(event) => {
                              const value = Number(event.target.value);
                              updateSetting(
                                'backups',
                                'retentionDays',
                                Number.isNaN(value) || value < 7 ? 7 : value
                              );
                            }}
                            className="bg-slate-950 border-slate-700 text-white"
                          />
                        </div>
                      </div>
                      {BACKUP_TOGGLES.map((toggle) => (
                        <ToggleRow
                          key={toggle.key}
                          icon={toggle.icon}
                          label={toggle.label}
                          description={toggle.description}
                          checked={settings.backups[toggle.key] as boolean}
                          onCheckedChange={(value) => updateSetting('backups', toggle.key, value)}
                        />
                      ))}
                      <div className="rounded-2xl border border-slate-800/70 bg-slate-950/40 p-4 text-xs text-slate-400 leading-5">
                        íÊã ÍİÙ ÇáäÓÎ ÇáÇÍÊíÇØíÉ İí ÓÍÇÈÉ ãÔİÑÉ. íãßäß ÊäÒíá äÓÎÉ íÏæíÉ Ãæ ÇÓÊÚÇÏÊåÇ ãä ÎáÇá áæÍÉ ÇáÊŞÇÑíÑ ÇáãÇáíÉ.
                      </div>
                    </CardContent>
                  </Card>

                  <Card className="border-slate-700/60 bg-slate-900/60">
                    <CardHeader>
                      <CardTitle className="text-white text-lg flex items-center gap-2">
                        <CloudDownload className="w-5 h-5 text-purple-300" />
                        ÂÎÑ äÓÎÉ ÇÍÊíÇØíÉ
                      </CardTitle>
                      <CardDescription className="text-slate-300">
                        ÊÍÏíË æŞÊ ÂÎÑ äÓÎÉ æÇáÊÃßÏ ãä ÌÇåÒíÉ ÎØÉ ÇáÇÓÊÌÇÈÉ ááØæÇÑÆ.
                      </CardDescription>
                    </CardHeader>
                    <CardContent className="space-y-5">
                      <div className="space-y-2">
                        <label className="text-sm text-slate-200">ÊÇÑíÎ ææŞÊ ÂÎÑ äÓÎÉ</label>
                        <Input
                          value={settings.backups.lastBackup}
                          onChange={(event) => updateSetting('backups', 'lastBackup', event.target.value)}
                          className="bg-slate-950 border-slate-700 text-white"
                        />
                        <p className="text-xs text-slate-400">
                          íÊã ÇÓÊÎÏÇã åĞå ÇáŞíãÉ áÅÑÓÇá ÊĞßíÑ ÊáŞÇÆí ŞÈá ÇáÍÇÌÉ Åáì ÇáäÓÎÉ ÇáÊÇáíÉ.
                        </p>
                      </div>
                      <Button
                        className="w-full bg-purple-600 hover:bg-purple-700 text-white"
                        onClick={() => router.push('/dashboard/accounting/cash-flow')}
                      >
                        ÊäÒíá ÓÌá ÇáäÓÎ ÇáÇÍÊíÇØíÉ
                      </Button>
                    </CardContent>
                  </Card>
                </div>
              </TabsContent>

              <TabsContent value="appearance" className="space-y-6">
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                  <Card className="border-slate-700/60 bg-slate-900/60">
                    <CardHeader>
                      <CardTitle className="text-white text-lg flex items-center gap-2">
                        <Palette className="w-5 h-5 text-purple-300" />
                        ÅÚÏÇÏÇÊ ÇáãÙåÑ
                      </CardTitle>
                      <CardDescription className="text-slate-300">
                        ÇÖÈØ ÇáÃáæÇä æßËÇİÉ ÇáæÇÌåÉ ÈãÇ íÊäÇÓÈ ãÚ åæíÉ ãäÔÃÊß.
                      </CardDescription>
                    </CardHeader>
                    <CardContent className="space-y-5">
                      <div className="space-y-2">
                        <label className="text-sm text-slate-200">áæä ÇáÊãííÒ</label>
                        <Select
                          value={settings.appearance.accentColor}
                          onValueChange={(value) => updateSetting('appearance', 'accentColor', value)}
                        >
                          <SelectTrigger className="bg-slate-950 border-slate-700 text-white">
                            <SelectValue placeholder="ÇÎÊÑ Çááæä" />
                          </SelectTrigger>
                          <SelectContent className="bg-slate-950 border-slate-700 text-white">
                            {ACCENT_OPTIONS.map((option) => (
                              <SelectItem key={option.value} value={option.value}>
                                {option.label}
                              </SelectItem>
                            ))}
                          </SelectContent>
                        </Select>
                      </div>
                      <div className="space-y-2">
                        <label className="text-sm text-slate-200">ßËÇİÉ ÇáæÇÌåÉ</label>
                        <Select
                          value={settings.appearance.layoutDensity}
                          onValueChange={(value) => updateSetting('appearance', 'layoutDensity', value)}
                        >
                          <SelectTrigger className="bg-slate-950 border-slate-700 text-white">
                            <SelectValue placeholder="ÇÎÊÑ ÇáßËÇİÉ" />
                          </SelectTrigger>
                          <SelectContent className="bg-slate-950 border-slate-700 text-white">
                            {DENSITY_OPTIONS.map((option) => (
                              <SelectItem key={option.value} value={option.value}>
                                {option.label}
                              </SelectItem>
                            ))}
                          </SelectContent>
                        </Select>
                      </div>
                      {APPEARANCE_TOGGLES.map((toggle) => (
                        <ToggleRow
                          key={toggle.key}
                          icon={toggle.icon}
                          label={toggle.label}
                          description={toggle.description}
                          checked={Boolean(settings.appearance[toggle.key])}
                          onCheckedChange={(value) => updateSetting('appearance', toggle.key, value)}
                        />
                      ))}
                    </CardContent>
                  </Card>

                  <Card className="border-slate-700/60 bg-slate-900/60">
                    <CardHeader>
                      <CardTitle className="text-white text-lg flex items-center gap-2">
                        <Sparkles className="w-5 h-5 text-purple-300" />
                        ãÚÇíäÉ ÇáæÇÌåÉ
                      </CardTitle>
                      <CardDescription className="text-slate-300">
                        ÊÃßÏ ãä ÊØÇÈŞ ÇáãÙåÑ ÇáäåÇÆí ãÚ åæíÉ ãäÔÃÊß ŞÈá ÇáÇÚÊãÇÏ.
                      </CardDescription>
                    </CardHeader>
                    <CardContent className="space-y-4">
                      <div className="rounded-2xl border border-slate-800/80 bg-gradient-to-br from-slate-950 via-slate-900 to-purple-950 p-6 space-y-4">
                        <div className="flex items-center justify-between">
                          <div className="space-y-1">
                            <p className="text-xs uppercase tracking-wide text-slate-400">ãÚÇíäÉ</p>
                            <p className="text-white font-semibold">{settings.general.companyName}</p>
                          </div>
                          <Badge className="bg-gray-800/50 border-white/20 text-white text-[11px]" variant="outline">
                            {settings.appearance.accentColor.toUpperCase()}
                          </Badge>
                        </div>
                        <div className="rounded-xl border border-slate-800/70 bg-slate-900/70 p-4 space-y-2">
                          <p className="text-sm text-slate-200">{settings.general.companyTagline}</p>
                          <p className="text-xs text-slate-400">
                            ßËÇİÉ ÇáæÇÌåÉ: {settings.appearance.layoutDensity === 'compact'
                              ? 'ãÖÛæØ'
                              : settings.appearance.layoutDensity === 'comfortable'
                                ? 'ãÑíÍ'
                                : 'æÇÓÚ'}
                          </p>
                        </div>
                        <div className="flex flex-wrap gap-2 text-xs text-slate-400">
                          <span className="px-3 py-1 rounded-full border border-purple-400/40 bg-purple-500/10 text-purple-200">
                            æÖÚ ÇáäÙÇã: {settings.general.systemMode === 'dark' ? 'ÏÇßä' : settings.general.systemMode === 'light' ? 'İÇÊÍ' : 'ÍÓÈ ÇáÌåÇÒ'}
                          </span>
                          {settings.appearance.bubbleBackground ? (
                            <span className="px-3 py-1 rounded-full border border-emerald-400/30 bg-emerald-500/10 text-emerald-200">
                              ÊÃËíÑ ÇáİŞÇÚÇÊ ãİÚá
                            </span>
                          ) : null}
                          {settings.appearance.animatedTransitions ? (
                            <span className="px-3 py-1 rounded-full border border-purple-400/30 bg-purple-500/10 text-purple-200">
                              ÇäÊŞÇáÇÊ ÏíäÇãíßíÉ
                            </span>
                          ) : null}
                          {settings.appearance.showTips ? (
                            <span className="px-3 py-1 rounded-full border border-amber-400/30 bg-amber-500/10 text-amber-200">
                              ÊáãíÍÇÊ ãİÚáÉ
                            </span>
                          ) : null}
                        </div>
                      </div>
                    </CardContent>
                  </Card>
                </div>
              </TabsContent>

              <TabsContent value="advanced" className="space-y-6">
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                  <Card className="border-slate-700/60 bg-slate-900/60">
                    <CardHeader>
                      <CardTitle className="text-white text-lg flex items-center gap-2">
                        <Zap className="w-5 h-5 text-purple-300" />
                        ÎíÇÑÇÊ ãÊŞÏãÉ
                      </CardTitle>
                      <CardDescription className="text-slate-300">
                        ÖÈØ Óáæß ÇáäÙÇã ÇáÊŞäí æÃÏæÇÊ ÇáãÑÇŞÈÉ ÇáãÊŞÏãÉ.
                      </CardDescription>
                    </CardHeader>
                    <CardContent className="space-y-4">
                      {ADVANCED_TOGGLES.map((toggle) => (
                        <ToggleRow
                          key={toggle.key}
                          icon={toggle.icon}
                          label={toggle.label}
                          description={toggle.description}
                          checked={Boolean(settings.advanced[toggle.key])}
                          onCheckedChange={(value) => updateSetting('advanced', toggle.key, value)}
                        />
                      ))}
                    </CardContent>
                  </Card>

                  <Card className="border-slate-700/60 bg-slate-900/60">
                    <CardHeader>
                      <CardTitle className="text-white text-lg flex items-center gap-2">
                        <ServerCog className="w-5 h-5 text-purple-300" />
                        ÅÏÇÑÉ ÇáÃÏÇÁ æÇáÊÎÒíä ÇáãÄŞÊ
                      </CardTitle>
                      <CardDescription className="text-slate-300">
                        ÖÈØ ÍÌã ÇáßÇÔ æãÊÇÈÚÉ ÚãáíÇÊ ÇáÕíÇäÉ ÇáãÓÊãÑÉ.
                      </CardDescription>
                    </CardHeader>
                    <CardContent className="space-y-5">
                      <div className="space-y-2">
                        <label className="text-sm text-slate-200">ÓÚÉ ÇáÊÎÒíä ÇáãÄŞÊ (ãíÌÇÈÇíÊ)</label>
                        <Input
                          type="number"
                          min={128}
                          value={settings.advanced.cacheSize}
                          onChange={(event) => {
                            const value = Number(event.target.value);
                            updateSetting(
                              'advanced',
                              'cacheSize',
                              Number.isNaN(value) || value < 128 ? 128 : value
                            );
                          }}
                          className="bg-slate-950 border-slate-700 text-white"
                        />
                      </div>
                      <div className="rounded-2xl border border-slate-800/70 bg-slate-950/40 p-4 text-xs text-slate-400 leading-5">
                        İÚøá ãÑÇŞÈÉ ÇáÃÏÇÁ ááÍÕæá Úáì ÅÔÚÇÑÇÊ İæÑíÉ ÚäÏ ÇÑÊİÇÚ ÇÓÊåáÇß ÇáãÚÇáÌ Ãæ ÇáĞÇßÑÉ¡ ãÚ ÊŞÇÑíÑ ÃÓÈæÚíÉ áÃÈÑÒ ÇáãÄÔÑÇÊ.
                      </div>
                      <Button
                        variant="outline"
                        className="w-full border-purple-400/40 text-purple-200 bg-purple-500/10 hover:bg-purple-500/20"
                        onClick={() => router.push('/dashboard/analytics')}
                      >
                        ÚÑÖ áæÍÉ ãÑÇŞÈÉ ÇáÃÏÇÁ
                      </Button>
                    </CardContent>
                  </Card>
                </div>
              </TabsContent>
            </Tabs>
          </CardContent>
        </Card>

        <footer className="text-center text-sm text-purple-300/50 py-4">
          <p>
            Êã ÊØæíÑ åĞÇ ÇáäÙÇã ÈæÇÓØÉ <span className="font-semibold text-purple-300/80">Eng/Akram elmasry</span>
          </p>
        </footer>
      </div>
    </div>
  );
}
