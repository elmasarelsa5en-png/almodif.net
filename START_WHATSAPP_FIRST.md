# ⚠️ تنبيه مهم جداً

## 🔴 يجب تشغيل خدمة الواتساب قبل استخدام النظام!

### لماذا تحتاج لتشغيل الخدمة؟
ميزة **التحقق من OTP** و **نسيت كلمة المرور** تعتمد على إرسال رسائل واتساب.

---

## 🚀 خطوات التشغيل (مرة واحدة فقط)

### 1️⃣ شغّل خدمة الواتساب
انقر نقراً مزدوجاً على الملف:
```
start-whatsapp-service.bat
```

ستفتح نافذة سوداء (Command Prompt) - **لا تغلقها أبداً**

---

### 2️⃣ امسح QR Code
افتح المتصفح واذهب إلى:
```
http://localhost:3002/api/qr
```

ستظهر لك صورة QR Code

---

### 3️⃣ اربط الواتساب
1. افتح تطبيق **واتساب** على جوالك
2. اذهب إلى **الإعدادات** ⚙️
3. اختر **الأجهزة المرتبطة** 📱
4. اضغط **ربط جهاز**
5. امسح الـ QR Code الذي ظهر في المتصفح

---

### 4️⃣ شغّل التطبيق
افتح terminal جديد (لا تغلق نافذة الواتساب!) واكتب:
```bash
npm run dev
```

---

## ✅ الآن جاهز!

### جرّب الميزات:
- **تسجيل نزيل جديد** → يصلك كود OTP على الواتساب
- **نسيت كلمة المرور** → تصلك كلمة المرور على الواتساب

---

## 🐛 حل المشاكل

### المشكلة: "خدمة الواتساب غير متاحة"
**الحل:**
1. تأكد أن نافذة `start-whatsapp-service.bat` مفتوحة ولم تُغلق
2. افحص أنه مكتوب "WhatsApp service running on port 3002"
3. افتح `http://localhost:3002/api/status` للتأكد من الاتصال

### المشكلة: "Cannot read properties of undefined"
**الحل:**
- تم إصلاحها في آخر تحديث (commit: 415a900)

### المشكلة: QR Code لا يظهر
**الحل:**
1. أغلق نافذة خدمة الواتساب
2. احذف مجلد `server/whatsapp-data/`
3. شغّل `start-whatsapp-service.bat` مرة أخرى

---

## 📝 ملاحظات مهمة

✅ **بعد المسح الأول:**
- الواتساب سيبقى متصل حتى لو أغلقت التطبيق
- البيانات محفوظة في `server/whatsapp-data/`
- لن تحتاج لمسح QR Code مرة أخرى

✅ **الأرقام السعودية:**
- يُضاف 966 تلقائياً
- مثال: `0501234567` → `966501234567`

✅ **مدة OTP:**
- صالح لمدة 10 دقائق فقط

---

## 🎯 الترتيب الصحيح للتشغيل:

```
1. start-whatsapp-service.bat  (نافذة سوداء تبقى مفتوحة)
   ↓
2. مسح QR Code من الواتساب (مرة واحدة)
   ↓
3. npm run dev  (في terminal جديد)
   ↓
4. استخدم التطبيق بحرية ✅
```

---

**تم بحمد الله ✨**
